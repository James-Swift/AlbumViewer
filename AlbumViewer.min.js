var AlbumViewer=AlbumViewer||function(){"use strict";var e,t,a,i,n,l,o,m,c,s,r,d,g,u,I,b=0;return u=navigator.userAgent.match(/\bMSIE\b/)&&(!document.documentMode||document.documentMode<9)?!0:!1,I=!/\bMSIE 6/.test(navigator.userAgent)&&!/\bMSIE 7/.test(navigator.userAgent)||window.opera?!1:!0,e=function(e){if(!(this instanceof AlbumViewer))throw new Error('Constructor called as a function. (In other words you forgot the "new" keyword.)');var u=this,I={};if(b+=1,u.blankImage=e.blankImage||"http://james-swift.com/images/blank.gif",u.fadeStep=e.fadeStep||2,u.fadeTime=e.fadeTime||12,u.slideshowDelay=e.slideshowDelay||5e3,u.slideshowRandom=e.slideshowRandom||!1,u.endlessAlbum=void 0===e.endlessAlbum||e.endlessAlbum===!0?!0:!1,u.fadeBoth=e.fadeBoth||!0,I.c1={},I.c2={},I.slideshowStopped=!0,I.instanceID=b,I.enableLinks=void 0===e.enableLinks||e.enableLinks===!0?!0:!1,I.loading=!1,I.loadingStartedCalled=!1,u.selectedImageID=null,u.selectedImageSrc=null,u.history=[],null!==e.container&&null!==document.getElementById(e.container)&&(I.c0=document.getElementById(e.container),t(I,u),e.container1="AlbumViewer_"+I.instanceID+"_t1",e.link1="AlbumViewer_"+I.instanceID+"_l1",e.img1="AlbumViewer_"+I.instanceID+"_i1",e.container2="AlbumViewer_"+I.instanceID+"_t2",e.link2="AlbumViewer_"+I.instanceID+"_l2",e.img2="AlbumViewer_"+I.instanceID+"_i2"),null===document.getElementById(e.container1)||null===document.getElementById(e.img1)||null===document.getElementById(e.container2)||null===document.getElementById(e.img2)||I.enableLinks!==!1&&(null===document.getElementById(e.link1)||null===document.getElementById(e.link2)))throw{name:"Error",message:"Not all elements could be found. Please check the correct element id has been specified. Unable to load album viewer."};return I.c1.table=document.getElementById(e.container1),I.c1.img=document.getElementById(e.img1),I.c2.table=document.getElementById(e.container2),I.c2.img=document.getElementById(e.img2),I.enableLinks===!0&&(I.c1.link=document.getElementById(e.link1),I.c2.link=document.getElementById(e.link2)),null!==e.container&&(I.c1.img.style.width="auto",I.c1.img.style.height="auto",I.c2.img.style.width="auto",I.c2.img.style.height="auto"),u.args=e,u.onSwitchTo=function(){},u.loadingStarted=function(){},u.loadingComplete=function(){},u.getSrc=function(e){var t;return t=this.imagesAreArrays===!0?this.albumImages[e][this.imageNameField]:this.albumImages[e],null===this.albumLocation?t:this.albumLocation+t},u.getAlt=function(e){return this.imagesAreArrays===!0?this.albumImages[e][this.imageNameField].substr(this.albumImages[e][this.imageNameField].lastIndexOf("/")+1):this.albumImages[e].substr(this.albumImages[e].lastIndexOf("/")+1)},u.getLink=function(e){var t;return t=this.imagesAreArrays===!0?this.albumImages[e][this.imageNameField]:this.albumImages[e],null===this.albumLocation?t:this.albumLocation+t},u.loadAlbum=function(e){return a(e,I,u)},u.switchTo=function(e){return i(e,I,u)},u.safeImageID=function(e){return l(e,I,u)},u.findImageID=function(e){return o(e,I,u)},u.slideshowStart=function(e,t){return c(e,t,I,u)},u.slideshowStop=function(){return m(I,u)},u.slideshowToggle=function(){return s(I,u)},u.imageNext=function(){return r(I,u)},u.imagePrevious=function(){return d(I,u)},u.imageRandom=function(){return g(I,u)},I.fade=function(){return n(I,u)},u},t=function(e,t){var a,i={};for(e.c0.innerHTML="",a=1;2>=a;a+=1)i.table=document.createElement("table"),i.table.setAttribute("id","AlbumViewer_"+e.instanceID+"_t"+a),i.table.setAttribute("cellpadding","0"),i.table.setAttribute("cellspacing","0"),i.table.style.position="absolute",i.table.style.zIndex=a,i.table.style.verticalAlign="middle",i.table.style.textAlign="center",i.table.style.width="100%",i.table.style.height="100%",i.tbody=document.createElement("tbody"),i.tr=document.createElement("tr"),i.td=document.createElement("td"),e.enableLinks===!0?(i.a=document.createElement("a"),i.a.setAttribute("target","_blank"),i.a.setAttribute("id","AlbumViewer_"+e.instanceID+"_l"+a),i.img=document.createElement("img"),i.img.setAttribute("id","AlbumViewer_"+e.instanceID+"_i"+a),i.img.setAttribute("src",t.blankImage),i.img.setAttribute("alt","Loading"),i.a.appendChild(i.img),i.td.appendChild(i.a)):(i.img=document.createElement("img"),i.img.setAttribute("id","AlbumViewer_"+e.instanceID+"_i"+a),i.img.setAttribute("src",t.blankImage),i.img.setAttribute("alt","Loading"),i.td.appendChild(i.img)),i.tr.appendChild(i.td),i.tbody.appendChild(i.tr),i.table.appendChild(i.tbody),e.c0.appendChild(i.table);return!0},a=function(e,t,a){if("object"==typeof e){if("object"==typeof e.images){var i,n=e.images;e.images=[];for(i in n)n.hasOwnProperty(i)&&e.images.push(n[i])}if(e.name&&e.images&&e.images.length>0&&(null===e.location||"string"==typeof e.location))return a.slideshowStop(),a.albumName=e.name,a.albumImages=e.images,a.selectedImageID=null,a.selectedImageID=null,a.imageNameField=e.imageNameField||"name",a.imagesAreArrays=!1,"string"!=typeof a.albumImages[0]&&(a.imagesAreArrays=!0),null!==e.location?(e.location=e.location.replace(/\\/g,"/"),a.albumLocation="/"!==e.location.charAt(e.location.length-1)?e.location+"/":e.location):a.albumLocation=null,t.selectedImageID=-1,t.selectedContainer=1,t.c1.opacity=100,t.c2.opacity=0,t.imageNameField=a.imageNameField,t.imagesAreArrays=a.imagesAreArrays,u===!1?(t.c1.table.style.opacity=t.c1.opacity/100,t.c2.table.style.opacity=t.c2.opacity/100):(t.c1.table.style.filter="alpha(opacity="+t.c1.opacity+")",t.c2.table.style.filter="alpha(opacity="+t.c2.opacity+")"),!0}throw{name:"InvalidObject",message:"The album object you passed is invalid. Please make sure it contains the properties 'name','images' (and array of 1 or more image file names) and 'location' (the path to the folder containing the images)."}},i=function(e,t,a){return t.nextImageID=a.safeImageID(e),t.nextImageID!==t.selectedImageID||a.slideshowRandom!==!1&&t.slideshowStopped!==!1?(t.selectedImageID>-1&&a.history.unshift(t.selectedImageID),a.selectedImageID=t.nextImageID,t.imagesAreArrays===!0?a.selectedImageSrc=a.albumImages[t.nextImageID][t.imageNameField]:a.selectedImageSrc=a.albumImages[t.nextImageID],t.loading=!0,setTimeout(function(){t.loading===!0&&t.loadingStartedCalled===!1&&(a.loadingStarted(),t.loadingStartedCalled=!0)},10),1===t.selectedContainer?(t.c2.img.onload=null,t.c2.img.src=a.blankImage,t.c2.img.onload=function(){clearTimeout(t.timer),t.fade(),null===t.c1.img.onload&&t.loading===!0&&(t.loadingStartedCalled=!1,t.loading=!1,a.loadingComplete())},t.c2.img.src=a.getSrc(t.nextImageID),t.c2.img.alt=a.getAlt(t.nextImageID),t.enableLinks===!0&&(t.c2.link.href=a.getLink(t.nextImageID))):(t.c1.img.onload=null,t.c1.img.src=a.blankImage,t.c1.img.onload=function(){t.timer=clearTimeout(t.timer),t.fade(),null===t.c2.img.onload&&t.loading===!0&&(t.loadingStartedCalled=!1,t.loading=!1,a.loadingComplete())},t.c1.img.src=a.getSrc(t.nextImageID),t.c1.img.alt=a.getAlt(t.nextImageID),t.enableLinks===!0&&(t.c1.link.href=a.getLink(t.nextImageID))),a.onSwitchTo(t.nextImageID),!0):!0},n=function(e,t){return 1===e.selectedContainer?(e.c1.opacity=e.c1.opacity-t.fadeStep,e.c2.opacity=e.c2.opacity+t.fadeStep):(e.c1.opacity=e.c1.opacity+t.fadeStep,e.c2.opacity=e.c2.opacity-t.fadeStep),e.c1.opacity=e.c1.opacity<0?0:e.c1.opacity>100?100:e.c1.opacity,e.c2.opacity=e.c2.opacity<0?0:e.c2.opacity>100?100:e.c2.opacity,u===!1?(t.fadeBoth===!0&&(e.c1.table.style.opacity=e.c1.opacity/100),e.c2.table.style.opacity=e.c2.opacity/100):(t.fadeBoth===!0&&(e.c1.table.style.filter="alpha(opacity="+e.c1.opacity+")"),e.c2.table.style.filter="alpha(opacity="+e.c2.opacity+")"),e.c1.opacity<=0?e.c1.table.style.display="none":I?e.c1.table.style.display="inline-block":e.c1.table.style.display="table",e.c2.opacity<=0?e.c2.table.style.display="none":I?e.c2.table.style.display="inline-block":e.c2.table.style.display="table",e.c1.opacity>0&&e.c1.opacity<100?e.timer=setTimeout(function(){e.fade()},t.fadeTime):(e.selectedImageID=e.nextImageID,1===e.selectedContainer?(e.c2.img.onload=null,e.selectedContainer=2,null===e.c1.img.onload&&(e.c1.img.src=t.getSrc(t.safeImageID(e.selectedImageID+1)))):(e.c1.img.onload=null,e.selectedContainer=1,null===e.c2.img.onload&&(e.c2.img.src=t.getSrc(t.safeImageID(e.selectedImageID+1)))),e.slideshowStopped!==!0&&(t.slideshowRandom===!1?e.timer=setTimeout(function(){t.imageNext()},t.slideshowDelay):e.timer=setTimeout(function(){t.imageRandom()},t.slideshowDelay))),!0},l=function(e,t,a){if(e>=a.albumImages.length&&(e=a.endlessAlbum?0:a.albumImages.length-1),0>e&&(e=a.endlessAlbum?a.albumImages.length-1:0),void 0===a.albumImages[e]){for(;void 0===a.albumImages[e]&&e<=a.albumImages.length;)e+=1;void 0===a.albumImages[e]&&(e=0)}return e},o=function(e,t,a){var i,n=0;if(t.imagesAreArrays!==!0)return a.safeImageID(a.albumImages.indexOf(e));for(i in a.albumImages)if(a.albumImages.hasOwnProperty(i)){if(a.albumImages[i][t.imageNameField]===e)return n;n+=1}return!1},m=function(e,t){return window.clearTimeout(e.timer),e.c1.img.onload=null,e.c2.img.onload=null,e.slideshowStopped=!0,t.slideshowStopped=!0,!0},c=function(e,t,a,i){return i.slideshowStop(),a.slideshowStopped=!1,i.slideshowStopped=!1,e===!0&&(i.slideshowRandom=!0),i.slideshowRandom===!0?i.switchTo(Math.floor(Math.random()*(i.albumImages.length-1))):a.selectedImageID===i.albumImages.length-1?i.switchTo(0):null===t||void 0===t?i.imageNext():i.switchTo(t),!0},s=function(e,t){return e.slideshowStopped===!0?t.slideshowStart():t.slideshowStop(),!0},r=function(e,t){return t.switchTo(e.selectedImageID+1),!0},d=function(e,t){return t.switchTo(e.selectedImageID-1),!0},g=function(e,t){var a=-1;if(t.albumImages.length>2){do a=Math.round(Math.random()*(t.albumImages.length-1));while(a===e.selectedImageID)}else a=e.selectedImageID+1;return t.switchTo(a),!0},Array.indexOf||(Array.prototype.indexOf=function(e,t){var a;for(a=t||0;a<this.length;a+=1)if(this[a]===e)return a;return void 0}),e}();